(()=>{"use strict";!function(e){const{endpoint:t,nonce:r}=window.SiteTemplatePickerAdmin;e(document).ready((()=>{e("#template-site-id").select2({ajax:{url:t+"?_wpnonce="+r,dataType:"json",data:e=>({search:e.term,page:e.page||1})}})})),e(document).on("select2:open",(()=>{document.querySelector(".select2-search__field").focus()})),document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelectorAll(".wp-list-table tbody tr");let t=null;e.forEach((e=>{e.draggable=!0,e.addEventListener("dragstart",(e=>{t=e.target,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",t),e.target.classList.add("cboxol-dragging")}),!1),e.addEventListener("dragover",(e=>{e.preventDefault(),e.dataTransfer.dropEffect="move";const t="TR"===e.target.tagName?e.target:e.target.closest("tr");t.classList.add("cboxol-dragover"),t.addEventListener("dragleave",(()=>{t.classList.remove("cboxol-dragover")}))}),!1),e.addEventListener("drop",(e=>{const o="TR"===e.target.tagName?e.target:e.target.closest("tr");t!==o&&(t.parentNode.insertBefore(t,o.nextSibling||o),function(){const e=document.querySelectorAll(".wp-list-table tbody tr"),t=Array.from(e).map(((e,t)=>({id:e.id.replace("post-",""),position:t+1}))),o=new URLSearchParams;o.append("order",JSON.stringify(t)),o.append("security",r),fetch(ajaxurl+"?action=cboxol_update_site_template_order",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:o}).then((e=>e.json())).then((e=>console.log("Order updated",e))).catch((e=>console.error("Error updating order:",e)))}(),t.classList.add("cboxol-just-dropped"),setTimeout((()=>{t.classList.remove("cboxol-just-dropped")}),1e3)),document.querySelectorAll("tr").forEach((e=>{e.classList.remove("cboxol-dragover"),e.classList.remove("cboxol-dragging")}))}),!1)}))}))}(jQuery)})();